AI - FasterRCNN Train
https://www.kaggle.com/tomchaniii/pytorch-starter-fasterrcnn-inference

In [1]:
import pandas as pd
import numpy as np
import cv2
import os
import re

from PIL import Image

import albumentations as A
from albumentations.pytorch.transforms import ToTensorV2

import torch
import torchvision

from torchvision.models.detection.faster_rcnn import FastRCNNPredictor
from torchvision.models.detection import FasterRCNN
from torchvision.models.detection.rpn import AnchorGenerator

from torch.utils.data import DataLoader, Dataset
from torch.utils.data.sampler import SequentialSampler

from matplotlib import pyplot as plt

DIR_INPUT = '/kaggle/input/global-wheat-detection'
DIR_TRAIN = f'{DIR_INPUT}/train'
DIR_TEST = f'{DIR_INPUT}/test'
In [2]:
# Download TorchVision repo to use some files from
# references/detection
!git clone https://github.com/pytorch/vision.git && cd vision && git checkout v0.3.0

!cp vision/references/detection/utils.py ./
!cp vision/references/detection/transforms.py ./
!cp vision/references/detection/coco_eval.py ./
!cp vision/references/detection/engine.py ./
!cp vision/references/detection/coco_utils.py ./
!rm -rf vision
Cloning into 'vision'...
remote: Enumerating objects: 70, done.
remote: Counting objects: 100% (70/70), done.
remote: Compressing objects: 100% (58/58), done.
remote: Total 10661 (delta 29), reused 27 (delta 12), pack-reused 10591
Receiving objects: 100% (10661/10661), 11.93 MiB | 20.63 MiB/s, done.
Resolving deltas: 100% (7402/7402), done.
Note: checking out 'v0.3.0'.

You are in 'detached HEAD' state. You can look around, make experimental
changes and commit them, and you can discard any commits you make in this
state without impacting any branches by performing another checkout.

If you want to create a new branch to retain commits you create, you may
do so (now or later) by using -b with the checkout command again. Example:

  git checkout -b <new-branch-name>

HEAD is now at be37608 version check against PyTorch's CUDA version
In [3]:
!pip install cython
# Install pycocotools, the version by default in Colab
# has a bug fixed in https://github.com/cocodataset/cocoapi/pull/354
!pip install -U 'git+https://github.com/cocodataset/cocoapi.git#subdirectory=PythonAPI'
Requirement already satisfied: cython in /opt/conda/lib/python3.7/site-packages (0.29.16)
Collecting git+https://github.com/cocodataset/cocoapi.git#subdirectory=PythonAPI
  Cloning https://github.com/cocodataset/cocoapi.git to /tmp/pip-req-build-2k4q0zsv
  Running command git clone -q https://github.com/cocodataset/cocoapi.git /tmp/pip-req-build-2k4q0zsv
Requirement already satisfied, skipping upgrade: setuptools>=18.0 in /opt/conda/lib/python3.7/site-packages (from pycocotools==2.0) (45.2.0.post20200209)
Requirement already satisfied, skipping upgrade: cython>=0.27.3 in /opt/conda/lib/python3.7/site-packages (from pycocotools==2.0) (0.29.16)
Requirement already satisfied, skipping upgrade: matplotlib>=2.1.0 in /opt/conda/lib/python3.7/site-packages (from pycocotools==2.0) (3.1.3)
Requirement already satisfied, skipping upgrade: kiwisolver>=1.0.1 in /opt/conda/lib/python3.7/site-packages (from matplotlib>=2.1.0->pycocotools==2.0) (1.1.0)
Requirement already satisfied, skipping upgrade: numpy>=1.11 in /opt/conda/lib/python3.7/site-packages (from matplotlib>=2.1.0->pycocotools==2.0) (1.18.1)
Requirement already satisfied, skipping upgrade: pyparsing!=2.0.4,!=2.1.2,!=2.1.6,>=2.0.1 in /opt/conda/lib/python3.7/site-packages (from matplotlib>=2.1.0->pycocotools==2.0) (2.4.6)
Requirement already satisfied, skipping upgrade: python-dateutil>=2.1 in /opt/conda/lib/python3.7/site-packages (from matplotlib>=2.1.0->pycocotools==2.0) (2.8.1)
Requirement already satisfied, skipping upgrade: cycler>=0.10 in /opt/conda/lib/python3.7/site-packages (from matplotlib>=2.1.0->pycocotools==2.0) (0.10.0)
Requirement already satisfied, skipping upgrade: six>=1.5 in /opt/conda/lib/python3.7/site-packages (from python-dateutil>=2.1->matplotlib>=2.1.0->pycocotools==2.0) (1.14.0)
Building wheels for collected packages: pycocotools
  Building wheel for pycocotools (setup.py) ... - \ | / - \ | / done
  Created wheel for pycocotools: filename=pycocotools-2.0-cp37-cp37m-linux_x86_64.whl size=279389 sha256=fe249d606b10cf6523c2ace7063b9e4eedc5263ff31d18131492891cb979b521
  Stored in directory: /tmp/pip-ephem-wheel-cache-0ighco_f/wheels/e2/6b/1d/344ac773c7495ea0b85eb228bc66daec7400a143a92d36b7b1
Successfully built pycocotools
Installing collected packages: pycocotools
Successfully installed pycocotools-2.0
In [4]:
train_df = pd.read_csv(f'{DIR_INPUT}/train.csv')
train_df.shape
Out[4]:
(147793, 5)
In [5]:
train_df['x'] = -1
train_df['y'] = -1
train_df['w'] = -1
train_df['h'] = -1

def expand_bbox(x):
    r = np.array(re.findall("([0-9]+[.]?[0-9]*)", x))
    if len(r) == 0:
        r = [-1, -1, -1, -1]
    return r

train_df[['x', 'y', 'w', 'h']] = np.stack(train_df['bbox'].apply(lambda x: expand_bbox(x)))
train_df.drop(columns=['bbox'], inplace=True)
train_df['x'] = train_df['x'].astype(np.float)
train_df['y'] = train_df['y'].astype(np.float)
train_df['w'] = train_df['w'].astype(np.float)
train_df['h'] = train_df['h'].astype(np.float)
In [6]:
image_ids = train_df['image_id'].unique()
valid_ids = image_ids[-500:]
train_ids = image_ids[:-500]
In [7]:
valid_df = train_df[train_df['image_id'].isin(valid_ids)]
train_df = train_df[train_df['image_id'].isin(train_ids)]
In [8]:
valid_df.shape, train_df.shape
Out[8]:
((17940, 8), (129853, 8))
In [9]:
import os
from PIL import Image
import math

class WheatDataset(Dataset):

    def __init__(self, dataframe, image_dir, transforms=None, noise=0, size_ratio=1):
        super().__init__()

        self.image_ids = dataframe['image_id'].unique()
        self.df = dataframe
        self.image_dir = image_dir
        self.transforms = transforms
        self.noise = noise
        self.size_ratio = size_ratio

    def __getitem__(self, index: int):
        
        if self.noise > 0:
            is_noise = index % 2
            index = math.floor(index / 2)

        image_id = self.image_ids[index]
        records = self.df[self.df['image_id'] == image_id]
        image = Image.open(os.path.join(self.image_dir, f'{image_id}.jpg')).convert("RGB")
        image = image.resize((round(image.width * self.size_ratio), round(image.height * self.size_ratio)))
        
        if self.noise > 0:
            if is_noise > 0:
                noise_image = Image.effect_noise(image.size, 127).convert("RGB")
                image = Image.blend(image, noise_image, self.noise)
                

        boxes = records[['x', 'y', 'w', 'h']].values
        
        boxes[:, 2] = np.clip(np.round((boxes[:, 0] + boxes[:, 2]) * self.size_ratio), 0, image.width)
        boxes[:, 3] = np.clip(np.round((boxes[:, 1] + boxes[:, 3]) * self.size_ratio), 0, image.height)
        boxes[:, 0] = np.clip(np.round(boxes[:, 0] * self.size_ratio), 0, image.width)
        boxes[:, 1] = np.clip(np.round(boxes[:, 1] * self.size_ratio), 0, image.height)
        
        
        area = (boxes[:, 3] - boxes[:, 1]) * (boxes[:, 2] - boxes[:, 0])
        area = torch.as_tensor(area, dtype=torch.float32)

        # there is only one class
        labels = torch.ones((records.shape[0],), dtype=torch.int64)
        
        # suppose all instances are not crowd
        iscrowd = torch.zeros((records.shape[0],), dtype=torch.int64)
        
        target = {}
        target['boxes'] = torch.as_tensor(boxes, dtype=torch.int64)
        target['labels'] = labels
        target['image_id'] = torch.tensor([index])
        target['area'] = area
        target['iscrowd'] = iscrowd

        if self.transforms is not None:
            image, target = self.transforms(image, target)

        return image, target

    def __len__(self) -> int:
        if self.noise > 0:
            return self.image_ids.shape[0] * 2
        else:
            return self.image_ids.shape[0]
In [10]:
# helper functions for data augmentation / transformation
from engine import train_one_epoch, evaluate
import transforms as T


def get_transform(train):
    transforms = []
    # converts the image, a PIL image, into a PyTorch Tensor
    transforms.append(T.ToTensor())
    if train:
        # during training, randomly flip the training images
        # and ground-truth for data augmentation
        transforms.append(T.RandomHorizontalFlip(0.5))
    return T.Compose(transforms)
Create the model
In [11]:
# load a model; pre-trained on COCO
model = torchvision.models.detection.fasterrcnn_resnet50_fpn(pretrained=True)
Downloading: "https://download.pytorch.org/models/fasterrcnn_resnet50_fpn_coco-258fb6c6.pth" to /root/.cache/torch/checkpoints/fasterrcnn_resnet50_fpn_coco-258fb6c6.pth
In [12]:
num_classes = 2  # 1 class (wheat) + background

# get number of input features for the classifier
in_features = model.roi_heads.box_predictor.cls_score.in_features

# replace the pre-trained head with a new one
model.roi_heads.box_predictor = FastRCNNPredictor(in_features, num_classes)
In [13]:
import utils

train_dataset = WheatDataset(train_df, DIR_TRAIN, get_transform(train=True), noise=0.2, size_ratio=1)
valid_dataset = WheatDataset(valid_df, DIR_TRAIN, get_transform(train=False))

train_data_loader = DataLoader(
    train_dataset,
    batch_size=16,
    shuffle=True,
    num_workers=4,
    collate_fn=utils.collate_fn
)

valid_data_loader = DataLoader(
    valid_dataset,
    batch_size=16,
    shuffle=True,
    num_workers=4,
    collate_fn=utils.collate_fn
)
In [14]:
sample, target = train_dataset[0]
fig, ax = plt.subplots(1, 1, figsize=(16, 8))

sample = sample.permute(1,2,0).cpu().numpy()
boxes = target['boxes'].data.cpu().numpy().astype(np.int32)

sample = cv2.UMat(sample).get()

for box in boxes:
    cv2.rectangle(
        sample, 
        (box[0], box[1]), 
        (box[2], box[3]),
        (220, 0, 0), 2)

ax.set_axis_off()
ax.imshow(sample)

sample, target = train_dataset[1]
fig, ax = plt.subplots(1, 1, figsize=(16, 8))

sample = sample.permute(1,2,0).cpu().numpy()
boxes = target['boxes'].data.cpu().numpy().astype(np.int32)

sample = cv2.UMat(sample).get()

for box in boxes:
    cv2.rectangle(
        sample, 
        (box[0], box[1]), 
        (box[2], box[3]),
        (220, 0, 0), 2)

ax.set_axis_off()
ax.imshow(sample)
Out[14]:
<matplotlib.image.AxesImage at 0x7fb2f8b3f950>


In [15]:
#for gpu
device = torch.device('cuda') if torch.cuda.is_available() else torch.device('cpu')
torch.cuda.empty_cache()
Train
In [16]:
model.to(device)
params = [p for p in model.parameters() if p.requires_grad]
optimizer = torch.optim.SGD(params, lr=0.00349, momentum=0.9, weight_decay=0.0004)
# lr_scheduler = torch.optim.lr_scheduler.StepLR(optimizer, step_size=3, gamma=0.1)
lr_scheduler = None

num_epochs = 8
In [17]:
import sys
sys.path.insert(0, "/kaggle/working")

from engine import train_one_epoch, evaluate

for epoch in range(num_epochs):
    # train for one epoch, printing every 10 iterations
    train_one_epoch(model, optimizer, train_data_loader, device, epoch, print_freq=20)
    
    # update the learning rate
    if lr_scheduler is not None:
        lr_scheduler.step()
        
    # evaluate on the test dataset
    evaluate(model, valid_data_loader, device=device)
Epoch: [0]  [  0/360]  eta: 1:35:57  lr: 0.000013  loss: 4.9157 (4.9157)  loss_classifier: 0.6449 (0.6449)  loss_box_reg: 0.3230 (0.3230)  loss_objectness: 3.6622 (3.6622)  loss_rpn_box_reg: 0.2856 (0.2856)  time: 15.9935  data: 10.8431  max mem: 11464
Epoch: [0]  [ 20/360]  eta: 0:21:02  lr: 0.000207  loss: 1.6751 (2.6253)  loss_classifier: 0.5869 (0.5874)  loss_box_reg: 0.3909 (0.3760)  loss_objectness: 0.4977 (1.4527)  loss_rpn_box_reg: 0.2038 (0.2092)  time: 3.0997  data: 0.7644  max mem: 11729
Epoch: [0]  [ 40/360]  eta: 0:17:33  lr: 0.000402  loss: 1.4039 (2.0377)  loss_classifier: 0.4901 (0.5350)  loss_box_reg: 0.4514 (0.4127)  loss_objectness: 0.2724 (0.8893)  loss_rpn_box_reg: 0.1928 (0.2006)  time: 2.8469  data: 0.5297  max mem: 11729
Epoch: [0]  [ 60/360]  eta: 0:15:36  lr: 0.000596  loss: 1.2321 (1.7715)  loss_classifier: 0.4081 (0.4941)  loss_box_reg: 0.4519 (0.4260)  loss_objectness: 0.1835 (0.6571)  loss_rpn_box_reg: 0.1790 (0.1942)  time: 2.7795  data: 0.5177  max mem: 11729
Epoch: [0]  [ 80/360]  eta: 0:14:17  lr: 0.000790  loss: 1.0684 (1.6021)  loss_classifier: 0.3583 (0.4621)  loss_box_reg: 0.3864 (0.4175)  loss_objectness: 0.1427 (0.5328)  loss_rpn_box_reg: 0.1795 (0.1898)  time: 2.8721  data: 0.6191  max mem: 11729
Epoch: [0]  [100/360]  eta: 0:13:07  lr: 0.000984  loss: 0.9311 (1.4703)  loss_classifier: 0.3210 (0.4347)  loss_box_reg: 0.3192 (0.3992)  loss_objectness: 0.1234 (0.4519)  loss_rpn_box_reg: 0.1628 (0.1844)  time: 2.8965  data: 0.7216  max mem: 11729
Epoch: [0]  [120/360]  eta: 0:13:11  lr: 0.001179  loss: 0.8788 (1.3732)  loss_classifier: 0.3072 (0.4135)  loss_box_reg: 0.2902 (0.3819)  loss_objectness: 0.1186 (0.3965)  loss_rpn_box_reg: 0.1620 (0.1812)  time: 4.6501  data: 2.6650  max mem: 11729
Epoch: [0]  [140/360]  eta: 0:12:02  lr: 0.001373  loss: 0.8445 (1.2999)  loss_classifier: 0.2923 (0.3971)  loss_box_reg: 0.2831 (0.3676)  loss_objectness: 0.1128 (0.3567)  loss_rpn_box_reg: 0.1574 (0.1785)  time: 3.2157  data: 1.0875  max mem: 11729
Epoch: [0]  [160/360]  eta: 0:11:02  lr: 0.001567  loss: 0.8043 (1.2389)  loss_classifier: 0.2767 (0.3831)  loss_box_reg: 0.2667 (0.3552)  loss_objectness: 0.0992 (0.3247)  loss_rpn_box_reg: 0.1571 (0.1759)  time: 3.5025  data: 1.3458  max mem: 11729
Epoch: [0]  [180/360]  eta: 0:09:45  lr: 0.001761  loss: 0.7916 (1.1918)  loss_classifier: 0.2810 (0.3722)  loss_box_reg: 0.2662 (0.3456)  loss_objectness: 0.0911 (0.2999)  loss_rpn_box_reg: 0.1553 (0.1741)  time: 2.7526  data: 0.5117  max mem: 11729
Epoch: [0]  [200/360]  eta: 0:08:34  lr: 0.001956  loss: 0.7610 (1.1488)  loss_classifier: 0.2625 (0.3614)  loss_box_reg: 0.2527 (0.3363)  loss_objectness: 0.0897 (0.2792)  loss_rpn_box_reg: 0.1502 (0.1719)  time: 2.9024  data: 0.6774  max mem: 11729
Epoch: [0]  [220/360]  eta: 0:07:22  lr: 0.002150  loss: 0.7477 (1.1131)  loss_classifier: 0.2667 (0.3525)  loss_box_reg: 0.2487 (0.3283)  loss_objectness: 0.0877 (0.2619)  loss_rpn_box_reg: 0.1504 (0.1704)  time: 2.5949  data: 0.4131  max mem: 11729
Epoch: [0]  [240/360]  eta: 0:06:16  lr: 0.002344  loss: 0.7469 (1.0823)  loss_classifier: 0.2557 (0.3446)  loss_box_reg: 0.2379 (0.3210)  loss_objectness: 0.0861 (0.2476)  loss_rpn_box_reg: 0.1488 (0.1692)  time: 2.8678  data: 0.6747  max mem: 11729
Epoch: [0]  [260/360]  eta: 0:05:09  lr: 0.002538  loss: 0.7373 (1.0564)  loss_classifier: 0.2537 (0.3378)  loss_box_reg: 0.2451 (0.3150)  loss_objectness: 0.0857 (0.2358)  loss_rpn_box_reg: 0.1467 (0.1678)  time: 2.6120  data: 0.3176  max mem: 11729
Epoch: [0]  [280/360]  eta: 0:04:04  lr: 0.002732  loss: 0.7111 (1.0320)  loss_classifier: 0.2513 (0.3315)  loss_box_reg: 0.2374 (0.3095)  loss_objectness: 0.0792 (0.2247)  loss_rpn_box_reg: 0.1481 (0.1664)  time: 2.6243  data: 0.3599  max mem: 11729
Epoch: [0]  [300/360]  eta: 0:03:02  lr: 0.002927  loss: 0.7236 (1.0126)  loss_classifier: 0.2542 (0.3266)  loss_box_reg: 0.2398 (0.3048)  loss_objectness: 0.0819 (0.2157)  loss_rpn_box_reg: 0.1478 (0.1655)  time: 2.7134  data: 0.4488  max mem: 11729
Epoch: [0]  [320/360]  eta: 0:02:01  lr: 0.003121  loss: 0.7184 (0.9953)  loss_classifier: 0.2531 (0.3220)  loss_box_reg: 0.2446 (0.3009)  loss_objectness: 0.0835 (0.2077)  loss_rpn_box_reg: 0.1449 (0.1646)  time: 2.8793  data: 0.6570  max mem: 11729
Epoch: [0]  [340/360]  eta: 0:01:00  lr: 0.003315  loss: 0.6903 (0.9779)  loss_classifier: 0.2416 (0.3175)  loss_box_reg: 0.2278 (0.2967)  loss_objectness: 0.0789 (0.2002)  loss_rpn_box_reg: 0.1416 (0.1636)  time: 2.9813  data: 0.6811  max mem: 11729
Epoch: [0]  [359/360]  eta: 0:00:03  lr: 0.003490  loss: 0.6956 (0.9633)  loss_classifier: 0.2404 (0.3136)  loss_box_reg: 0.2309 (0.2933)  loss_objectness: 0.0742 (0.1935)  loss_rpn_box_reg: 0.1495 (0.1628)  time: 2.5324  data: 0.5070  max mem: 11729
Epoch: [0] Total time: 0:18:00 (3.0009 s / it)
creating index...
index created!
Test:  [ 0/32]  eta: 0:05:35  model_time: 0.9478 (0.9478)  evaluator_time: 5.1581 (5.1581)  time: 10.4793  data: 4.1861  max mem: 11729
Test:  [31/32]  eta: 0:00:03  model_time: 0.6463 (0.6480)  evaluator_time: 2.3625 (2.4568)  time: 3.0415  data: 0.0809  max mem: 11729
Test: Total time: 0:01:48 (3.3825 s / it)
Averaged stats: model_time: 0.6463 (0.6480)  evaluator_time: 2.3625 (2.4568)
Accumulating evaluation results...
DONE (t=0.54s).
IoU metric: bbox
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.484
 Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.884
 Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=100 ] = 0.497
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.032
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.497
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.456
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=  1 ] = 0.019
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets= 10 ] = 0.170
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.559
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.094
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.573
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.517
Epoch: [1]  [  0/360]  eta: 1:16:56  lr: 0.003490  loss: 0.6390 (0.6390)  loss_classifier: 0.2316 (0.2316)  loss_box_reg: 0.2185 (0.2185)  loss_objectness: 0.0627 (0.0627)  loss_rpn_box_reg: 0.1262 (0.1262)  time: 12.8241  data: 10.6412  max mem: 11729
Epoch: [1]  [ 20/360]  eta: 0:20:10  lr: 0.003490  loss: 0.6960 (0.6885)  loss_classifier: 0.2378 (0.2388)  loss_box_reg: 0.2307 (0.2315)  loss_objectness: 0.0690 (0.0718)  loss_rpn_box_reg: 0.1444 (0.1463)  time: 3.0982  data: 0.8184  max mem: 11729
Epoch: [1]  [ 40/360]  eta: 0:17:32  lr: 0.003490  loss: 0.6759 (0.6882)  loss_classifier: 0.2423 (0.2416)  loss_box_reg: 0.2361 (0.2333)  loss_objectness: 0.0679 (0.0710)  loss_rpn_box_reg: 0.1381 (0.1424)  time: 3.0045  data: 0.7447  max mem: 11729
Epoch: [1]  [ 60/360]  eta: 0:15:29  lr: 0.003490  loss: 0.6658 (0.6844)  loss_classifier: 0.2322 (0.2390)  loss_box_reg: 0.2205 (0.2304)  loss_objectness: 0.0643 (0.0706)  loss_rpn_box_reg: 0.1417 (0.1444)  time: 2.7054  data: 0.4420  max mem: 11729
Epoch: [1]  [ 80/360]  eta: 0:14:05  lr: 0.003490  loss: 0.6733 (0.6837)  loss_classifier: 0.2336 (0.2378)  loss_box_reg: 0.2185 (0.2291)  loss_objectness: 0.0723 (0.0716)  loss_rpn_box_reg: 0.1440 (0.1452)  time: 2.7841  data: 0.5029  max mem: 11729
Epoch: [1]  [100/360]  eta: 0:13:09  lr: 0.003490  loss: 0.6650 (0.6803)  loss_classifier: 0.2311 (0.2368)  loss_box_reg: 0.2230 (0.2287)  loss_objectness: 0.0680 (0.0708)  loss_rpn_box_reg: 0.1387 (0.1440)  time: 3.0958  data: 0.8447  max mem: 11729
Epoch: [1]  [120/360]  eta: 0:11:58  lr: 0.003490  loss: 0.6269 (0.6745)  loss_classifier: 0.2256 (0.2353)  loss_box_reg: 0.2175 (0.2271)  loss_objectness: 0.0559 (0.0696)  loss_rpn_box_reg: 0.1345 (0.1425)  time: 2.7763  data: 0.5584  max mem: 11729
Epoch: [1]  [140/360]  eta: 0:10:53  lr: 0.003490  loss: 0.6649 (0.6721)  loss_classifier: 0.2366 (0.2350)  loss_box_reg: 0.2201 (0.2256)  loss_objectness: 0.0732 (0.0698)  loss_rpn_box_reg: 0.1361 (0.1417)  time: 2.8520  data: 0.6004  max mem: 11729
Epoch: [1]  [160/360]  eta: 0:09:49  lr: 0.003490  loss: 0.6774 (0.6714)  loss_classifier: 0.2373 (0.2349)  loss_box_reg: 0.2263 (0.2253)  loss_objectness: 0.0629 (0.0695)  loss_rpn_box_reg: 0.1436 (0.1417)  time: 2.7890  data: 0.5438  max mem: 11729
Epoch: [1]  [180/360]  eta: 0:08:48  lr: 0.003490  loss: 0.6506 (0.6702)  loss_classifier: 0.2344 (0.2347)  loss_box_reg: 0.2174 (0.2245)  loss_objectness: 0.0610 (0.0691)  loss_rpn_box_reg: 0.1390 (0.1419)  time: 2.8367  data: 0.5509  max mem: 11729
Epoch: [1]  [200/360]  eta: 0:07:48  lr: 0.003490  loss: 0.6521 (0.6682)  loss_classifier: 0.2266 (0.2344)  loss_box_reg: 0.2139 (0.2236)  loss_objectness: 0.0630 (0.0687)  loss_rpn_box_reg: 0.1373 (0.1415)  time: 2.8157  data: 0.5607  max mem: 11729
Epoch: [1]  [220/360]  eta: 0:06:50  lr: 0.003490  loss: 0.6548 (0.6676)  loss_classifier: 0.2354 (0.2344)  loss_box_reg: 0.2174 (0.2234)  loss_objectness: 0.0607 (0.0685)  loss_rpn_box_reg: 0.1362 (0.1413)  time: 2.9859  data: 0.7232  max mem: 11729
Epoch: [1]  [240/360]  eta: 0:05:50  lr: 0.003490  loss: 0.6404 (0.6668)  loss_classifier: 0.2319 (0.2343)  loss_box_reg: 0.2181 (0.2232)  loss_objectness: 0.0619 (0.0679)  loss_rpn_box_reg: 0.1430 (0.1414)  time: 2.8104  data: 0.5477  max mem: 11729
Epoch: [1]  [260/360]  eta: 0:04:51  lr: 0.003490  loss: 0.6393 (0.6662)  loss_classifier: 0.2205 (0.2336)  loss_box_reg: 0.2115 (0.2227)  loss_objectness: 0.0643 (0.0680)  loss_rpn_box_reg: 0.1418 (0.1419)  time: 2.8143  data: 0.5439  max mem: 11729
Epoch: [1]  [280/360]  eta: 0:03:51  lr: 0.003490  loss: 0.6452 (0.6644)  loss_classifier: 0.2218 (0.2328)  loss_box_reg: 0.2146 (0.2220)  loss_objectness: 0.0586 (0.0678)  loss_rpn_box_reg: 0.1390 (0.1418)  time: 2.7216  data: 0.4087  max mem: 11729
Epoch: [1]  [300/360]  eta: 0:02:53  lr: 0.003490  loss: 0.6193 (0.6618)  loss_classifier: 0.2184 (0.2318)  loss_box_reg: 0.2103 (0.2214)  loss_objectness: 0.0559 (0.0672)  loss_rpn_box_reg: 0.1370 (0.1414)  time: 2.8123  data: 0.5474  max mem: 11729
Epoch: [1]  [320/360]  eta: 0:01:55  lr: 0.003490  loss: 0.6259 (0.6599)  loss_classifier: 0.2161 (0.2312)  loss_box_reg: 0.2175 (0.2210)  loss_objectness: 0.0577 (0.0666)  loss_rpn_box_reg: 0.1352 (0.1412)  time: 2.9531  data: 0.6963  max mem: 11729
Epoch: [1]  [340/360]  eta: 0:00:57  lr: 0.003490  loss: 0.6271 (0.6589)  loss_classifier: 0.2208 (0.2307)  loss_box_reg: 0.2135 (0.2204)  loss_objectness: 0.0560 (0.0666)  loss_rpn_box_reg: 0.1363 (0.1412)  time: 2.9393  data: 0.7064  max mem: 11729
Epoch: [1]  [359/360]  eta: 0:00:02  lr: 0.003490  loss: 0.6579 (0.6589)  loss_classifier: 0.2266 (0.2307)  loss_box_reg: 0.2213 (0.2203)  loss_objectness: 0.0601 (0.0664)  loss_rpn_box_reg: 0.1448 (0.1414)  time: 2.3226  data: 0.2899  max mem: 11729
Epoch: [1] Total time: 0:17:12 (2.8670 s / it)
creating index...
index created!
Test:  [ 0/32]  eta: 0:05:32  model_time: 0.8116 (0.8116)  evaluator_time: 4.3175 (4.3175)  time: 10.3947  data: 5.1102  max mem: 11729
Test:  [31/32]  eta: 0:00:03  model_time: 0.6429 (0.6444)  evaluator_time: 2.4253 (2.4862)  time: 3.1336  data: 0.0784  max mem: 11729
Test: Total time: 0:01:49 (3.4289 s / it)
Averaged stats: model_time: 0.6429 (0.6444)  evaluator_time: 2.4253 (2.4862)
Accumulating evaluation results...
DONE (t=0.57s).
IoU metric: bbox
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.498
 Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.905
 Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=100 ] = 0.508
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.053
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.509
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.480
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=  1 ] = 0.019
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets= 10 ] = 0.172
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.575
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.122
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.583
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.557
Epoch: [2]  [  0/360]  eta: 1:00:10  lr: 0.003490  loss: 0.5509 (0.5509)  loss_classifier: 0.2048 (0.2048)  loss_box_reg: 0.1948 (0.1948)  loss_objectness: 0.0341 (0.0341)  loss_rpn_box_reg: 0.1172 (0.1172)  time: 10.0298  data: 7.7199  max mem: 11729
Epoch: [2]  [ 20/360]  eta: 0:19:29  lr: 0.003490  loss: 0.6291 (0.6284)  loss_classifier: 0.2223 (0.2228)  loss_box_reg: 0.2096 (0.2119)  loss_objectness: 0.0552 (0.0579)  loss_rpn_box_reg: 0.1333 (0.1358)  time: 3.1091  data: 0.8175  max mem: 11729
Epoch: [2]  [ 40/360]  eta: 0:16:37  lr: 0.003490  loss: 0.6069 (0.6232)  loss_classifier: 0.2140 (0.2198)  loss_box_reg: 0.2066 (0.2103)  loss_objectness: 0.0550 (0.0572)  loss_rpn_box_reg: 0.1341 (0.1360)  time: 2.7804  data: 0.5171  max mem: 11729
Epoch: [2]  [ 60/360]  eta: 0:14:57  lr: 0.003490  loss: 0.6136 (0.6196)  loss_classifier: 0.2204 (0.2202)  loss_box_reg: 0.2063 (0.2092)  loss_objectness: 0.0552 (0.0568)  loss_rpn_box_reg: 0.1317 (0.1335)  time: 2.7311  data: 0.4766  max mem: 11729
Epoch: [2]  [ 80/360]  eta: 0:13:48  lr: 0.003490  loss: 0.6073 (0.6180)  loss_classifier: 0.2128 (0.2195)  loss_box_reg: 0.2052 (0.2093)  loss_objectness: 0.0539 (0.0564)  loss_rpn_box_reg: 0.1296 (0.1327)  time: 2.8551  data: 0.5815  max mem: 11729
Epoch: [2]  [100/360]  eta: 0:12:49  lr: 0.003490  loss: 0.6225 (0.6205)  loss_classifier: 0.2213 (0.2197)  loss_box_reg: 0.2139 (0.2105)  loss_objectness: 0.0579 (0.0570)  loss_rpn_box_reg: 0.1347 (0.1334)  time: 2.9696  data: 0.5971  max mem: 11729
Epoch: [2]  [120/360]  eta: 0:11:49  lr: 0.003490  loss: 0.6009 (0.6180)  loss_classifier: 0.2099 (0.2180)  loss_box_reg: 0.2069 (0.2095)  loss_objectness: 0.0509 (0.0566)  loss_rpn_box_reg: 0.1334 (0.1339)  time: 2.9400  data: 0.6489  max mem: 11729
Epoch: [2]  [140/360]  eta: 0:10:55  lr: 0.003490  loss: 0.6322 (0.6193)  loss_classifier: 0.2183 (0.2178)  loss_box_reg: 0.2087 (0.2097)  loss_objectness: 0.0557 (0.0567)  loss_rpn_box_reg: 0.1420 (0.1350)  time: 3.1233  data: 0.7929  max mem: 11729
Epoch: [2]  [160/360]  eta: 0:09:56  lr: 0.003490  loss: 0.6206 (0.6190)  loss_classifier: 0.2141 (0.2172)  loss_box_reg: 0.2077 (0.2093)  loss_objectness: 0.0606 (0.0570)  loss_rpn_box_reg: 0.1340 (0.1354)  time: 3.0187  data: 0.7194  max mem: 11729
Epoch: [2]  [180/360]  eta: 0:08:56  lr: 0.003490  loss: 0.5911 (0.6170)  loss_classifier: 0.2111 (0.2168)  loss_box_reg: 0.1988 (0.2083)  loss_objectness: 0.0531 (0.0568)  loss_rpn_box_reg: 0.1326 (0.1351)  time: 2.9320  data: 0.6258  max mem: 11729
Epoch: [2]  [200/360]  eta: 0:07:57  lr: 0.003490  loss: 0.6069 (0.6168)  loss_classifier: 0.2130 (0.2167)  loss_box_reg: 0.2087 (0.2084)  loss_objectness: 0.0526 (0.0565)  loss_rpn_box_reg: 0.1338 (0.1351)  time: 3.0393  data: 0.7457  max mem: 11729
Epoch: [2]  [220/360]  eta: 0:06:59  lr: 0.003490  loss: 0.5956 (0.6148)  loss_classifier: 0.2028 (0.2157)  loss_box_reg: 0.2007 (0.2081)  loss_objectness: 0.0513 (0.0561)  loss_rpn_box_reg: 0.1313 (0.1348)  time: 3.1006  data: 0.8118  max mem: 11729
Epoch: [2]  [240/360]  eta: 0:06:02  lr: 0.003490  loss: 0.6381 (0.6166)  loss_classifier: 0.2218 (0.2164)  loss_box_reg: 0.2161 (0.2089)  loss_objectness: 0.0564 (0.0564)  loss_rpn_box_reg: 0.1337 (0.1349)  time: 3.2810  data: 0.9719  max mem: 11729
Epoch: [2]  [260/360]  eta: 0:05:03  lr: 0.003490  loss: 0.6098 (0.6168)  loss_classifier: 0.2100 (0.2162)  loss_box_reg: 0.2064 (0.2087)  loss_objectness: 0.0559 (0.0566)  loss_rpn_box_reg: 0.1320 (0.1353)  time: 3.2739  data: 0.9702  max mem: 11729
Epoch: [2]  [280/360]  eta: 0:04:03  lr: 0.003490  loss: 0.5898 (0.6151)  loss_classifier: 0.2095 (0.2159)  loss_box_reg: 0.2000 (0.2080)  loss_objectness: 0.0492 (0.0562)  loss_rpn_box_reg: 0.1336 (0.1350)  time: 3.0629  data: 0.7866  max mem: 11729
Epoch: [2]  [300/360]  eta: 0:03:03  lr: 0.003490  loss: 0.5988 (0.6138)  loss_classifier: 0.2053 (0.2155)  loss_box_reg: 0.2019 (0.2077)  loss_objectness: 0.0517 (0.0560)  loss_rpn_box_reg: 0.1331 (0.1347)  time: 3.2041  data: 0.9174  max mem: 11729
Epoch: [2]  [320/360]  eta: 0:02:02  lr: 0.003490  loss: 0.6223 (0.6148)  loss_classifier: 0.2223 (0.2158)  loss_box_reg: 0.2097 (0.2078)  loss_objectness: 0.0526 (0.0561)  loss_rpn_box_reg: 0.1365 (0.1350)  time: 3.1232  data: 0.8342  max mem: 11729
Epoch: [2]  [340/360]  eta: 0:01:01  lr: 0.003490  loss: 0.5973 (0.6140)  loss_classifier: 0.2047 (0.2153)  loss_box_reg: 0.2008 (0.2075)  loss_objectness: 0.0521 (0.0561)  loss_rpn_box_reg: 0.1310 (0.1351)  time: 3.1798  data: 0.8264  max mem: 11729
Epoch: [2]  [359/360]  eta: 0:00:03  lr: 0.003490  loss: 0.6236 (0.6142)  loss_classifier: 0.2238 (0.2157)  loss_box_reg: 0.2097 (0.2077)  loss_objectness: 0.0505 (0.0558)  loss_rpn_box_reg: 0.1346 (0.1350)  time: 2.5311  data: 0.4611  max mem: 11729
Epoch: [2] Total time: 0:18:12 (3.0357 s / it)
creating index...
index created!
Test:  [ 0/32]  eta: 0:05:30  model_time: 0.8651 (0.8651)  evaluator_time: 4.9726 (4.9726)  time: 10.3393  data: 4.2776  max mem: 11729
Test:  [31/32]  eta: 0:00:03  model_time: 0.6490 (0.6468)  evaluator_time: 2.2022 (2.4086)  time: 2.9995  data: 0.0870  max mem: 11729
Test: Total time: 0:01:47 (3.3468 s / it)
Averaged stats: model_time: 0.6490 (0.6468)  evaluator_time: 2.2022 (2.4086)
Accumulating evaluation results...
DONE (t=0.54s).
IoU metric: bbox
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.509
 Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.904
 Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=100 ] = 0.534
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.051
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.521
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.485
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=  1 ] = 0.019
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets= 10 ] = 0.175
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.580
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.144
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.591
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.548
Epoch: [3]  [  0/360]  eta: 1:23:45  lr: 0.003490  loss: 0.6424 (0.6424)  loss_classifier: 0.2305 (0.2305)  loss_box_reg: 0.2237 (0.2237)  loss_objectness: 0.0545 (0.0545)  loss_rpn_box_reg: 0.1337 (0.1337)  time: 13.9589  data: 11.5216  max mem: 11729
Epoch: [3]  [ 20/360]  eta: 0:19:46  lr: 0.003490  loss: 0.5908 (0.5910)  loss_classifier: 0.2084 (0.2076)  loss_box_reg: 0.2011 (0.2028)  loss_objectness: 0.0470 (0.0501)  loss_rpn_box_reg: 0.1265 (0.1305)  time: 2.9653  data: 0.6447  max mem: 11729
Epoch: [3]  [ 40/360]  eta: 0:17:43  lr: 0.003490  loss: 0.6001 (0.5973)  loss_classifier: 0.2098 (0.2101)  loss_box_reg: 0.2102 (0.2060)  loss_objectness: 0.0461 (0.0494)  loss_rpn_box_reg: 0.1308 (0.1320)  time: 3.1501  data: 0.8028  max mem: 11729
Epoch: [3]  [ 60/360]  eta: 0:16:26  lr: 0.003490  loss: 0.5933 (0.5962)  loss_classifier: 0.2072 (0.2095)  loss_box_reg: 0.2008 (0.2052)  loss_objectness: 0.0492 (0.0492)  loss_rpn_box_reg: 0.1318 (0.1324)  time: 3.2166  data: 0.9307  max mem: 11729
Epoch: [3]  [ 80/360]  eta: 0:14:56  lr: 0.003490  loss: 0.6286 (0.6006)  loss_classifier: 0.2136 (0.2109)  loss_box_reg: 0.2127 (0.2061)  loss_objectness: 0.0515 (0.0504)  loss_rpn_box_reg: 0.1373 (0.1331)  time: 2.9415  data: 0.6234  max mem: 11729
Epoch: [3]  [100/360]  eta: 0:13:43  lr: 0.003490  loss: 0.6043 (0.6008)  loss_classifier: 0.2118 (0.2112)  loss_box_reg: 0.2030 (0.2054)  loss_objectness: 0.0508 (0.0510)  loss_rpn_box_reg: 0.1321 (0.1332)  time: 3.0213  data: 0.7171  max mem: 11729
Epoch: [3]  [120/360]  eta: 0:12:39  lr: 0.003490  loss: 0.5822 (0.5987)  loss_classifier: 0.2028 (0.2107)  loss_box_reg: 0.1987 (0.2049)  loss_objectness: 0.0504 (0.0510)  loss_rpn_box_reg: 0.1246 (0.1322)  time: 3.1489  data: 0.8290  max mem: 11729
Epoch: [3]  [140/360]  eta: 0:11:30  lr: 0.003490  loss: 0.6004 (0.6000)  loss_classifier: 0.2123 (0.2113)  loss_box_reg: 0.2035 (0.2050)  loss_objectness: 0.0514 (0.0511)  loss_rpn_box_reg: 0.1310 (0.1326)  time: 2.9919  data: 0.6471  max mem: 11729
Epoch: [3]  [160/360]  eta: 0:10:29  lr: 0.003490  loss: 0.5969 (0.5997)  loss_classifier: 0.2070 (0.2110)  loss_box_reg: 0.2029 (0.2048)  loss_objectness: 0.0512 (0.0511)  loss_rpn_box_reg: 0.1311 (0.1327)  time: 3.2055  data: 0.8250  max mem: 11729
Epoch: [3]  [180/360]  eta: 0:09:27  lr: 0.003490  loss: 0.5888 (0.5993)  loss_classifier: 0.2057 (0.2107)  loss_box_reg: 0.2010 (0.2047)  loss_objectness: 0.0494 (0.0511)  loss_rpn_box_reg: 0.1326 (0.1327)  time: 3.2148  data: 0.8588  max mem: 11729
Epoch: [3]  [200/360]  eta: 0:08:25  lr: 0.003490  loss: 0.5912 (0.5988)  loss_classifier: 0.2067 (0.2103)  loss_box_reg: 0.1956 (0.2042)  loss_objectness: 0.0536 (0.0513)  loss_rpn_box_reg: 0.1340 (0.1330)  time: 3.2116  data: 0.9014  max mem: 11729
Epoch: [3]  [220/360]  eta: 0:07:21  lr: 0.003490  loss: 0.5671 (0.5964)  loss_classifier: 0.1997 (0.2093)  loss_box_reg: 0.1923 (0.2034)  loss_objectness: 0.0465 (0.0511)  loss_rpn_box_reg: 0.1270 (0.1326)  time: 3.0690  data: 0.7814  max mem: 11729
Epoch: [3]  [240/360]  eta: 0:06:17  lr: 0.003490  loss: 0.5892 (0.5963)  loss_classifier: 0.2165 (0.2096)  loss_box_reg: 0.2012 (0.2031)  loss_objectness: 0.0454 (0.0510)  loss_rpn_box_reg: 0.1259 (0.1327)  time: 3.0884  data: 0.7559  max mem: 11729
Epoch: [3]  [260/360]  eta: 0:05:13  lr: 0.003490  loss: 0.5865 (0.5965)  loss_classifier: 0.2105 (0.2097)  loss_box_reg: 0.2008 (0.2031)  loss_objectness: 0.0489 (0.0510)  loss_rpn_box_reg: 0.1330 (0.1326)  time: 3.0530  data: 0.7153  max mem: 11729
Epoch: [3]  [280/360]  eta: 0:04:09  lr: 0.003490  loss: 0.5684 (0.5948)  loss_classifier: 0.2021 (0.2093)  loss_box_reg: 0.1930 (0.2024)  loss_objectness: 0.0497 (0.0510)  loss_rpn_box_reg: 0.1248 (0.1321)  time: 2.8978  data: 0.5800  max mem: 11729
Epoch: [3]  [300/360]  eta: 0:03:07  lr: 0.003490  loss: 0.5749 (0.5940)  loss_classifier: 0.2091 (0.2091)  loss_box_reg: 0.2023 (0.2025)  loss_objectness: 0.0449 (0.0507)  loss_rpn_box_reg: 0.1265 (0.1317)  time: 3.1036  data: 0.7590  max mem: 11729
Epoch: [3]  [320/360]  eta: 0:02:05  lr: 0.003490  loss: 0.5929 (0.5944)  loss_classifier: 0.2082 (0.2092)  loss_box_reg: 0.1993 (0.2024)  loss_objectness: 0.0508 (0.0510)  loss_rpn_box_reg: 0.1309 (0.1319)  time: 3.2077  data: 0.9107  max mem: 11729
Epoch: [3]  [340/360]  eta: 0:01:02  lr: 0.003490  loss: 0.5805 (0.5939)  loss_classifier: 0.2067 (0.2091)  loss_box_reg: 0.1980 (0.2024)  loss_objectness: 0.0469 (0.0507)  loss_rpn_box_reg: 0.1298 (0.1317)  time: 3.0116  data: 0.7083  max mem: 11729
Epoch: [3]  [359/360]  eta: 0:00:03  lr: 0.003490  loss: 0.5912 (0.5942)  loss_classifier: 0.2101 (0.2090)  loss_box_reg: 0.1982 (0.2022)  loss_objectness: 0.0500 (0.0508)  loss_rpn_box_reg: 0.1358 (0.1321)  time: 2.8516  data: 0.8043  max mem: 11729
Epoch: [3] Total time: 0:18:38 (3.1074 s / it)
creating index...
index created!
Test:  [ 0/32]  eta: 0:06:04  model_time: 0.8717 (0.8717)  evaluator_time: 4.8666 (4.8666)  time: 11.3871  data: 5.3796  max mem: 11729
Test:  [31/32]  eta: 0:00:03  model_time: 0.6518 (0.6465)  evaluator_time: 2.3735 (2.5358)  time: 3.1167  data: 0.0912  max mem: 11729
Test: Total time: 0:01:52 (3.5063 s / it)
Averaged stats: model_time: 0.6518 (0.6465)  evaluator_time: 2.3735 (2.5358)
Accumulating evaluation results...
DONE (t=0.59s).
IoU metric: bbox
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.519
 Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.914
 Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=100 ] = 0.552
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.052
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.531
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.486
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=  1 ] = 0.019
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets= 10 ] = 0.176
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.590
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.139
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.604
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.549
Epoch: [4]  [  0/360]  eta: 1:16:46  lr: 0.003490  loss: 0.5420 (0.5420)  loss_classifier: 0.1856 (0.1856)  loss_box_reg: 0.1827 (0.1827)  loss_objectness: 0.0406 (0.0406)  loss_rpn_box_reg: 0.1331 (0.1331)  time: 12.7945  data: 10.3498  max mem: 11729
Epoch: [4]  [ 20/360]  eta: 0:20:50  lr: 0.003490  loss: 0.5866 (0.5827)  loss_classifier: 0.1992 (0.2009)  loss_box_reg: 0.1950 (0.1977)  loss_objectness: 0.0510 (0.0525)  loss_rpn_box_reg: 0.1287 (0.1316)  time: 3.2226  data: 0.8773  max mem: 11729
Epoch: [4]  [ 40/360]  eta: 0:18:15  lr: 0.003490  loss: 0.5766 (0.5851)  loss_classifier: 0.2044 (0.2026)  loss_box_reg: 0.2030 (0.1991)  loss_objectness: 0.0494 (0.0506)  loss_rpn_box_reg: 0.1328 (0.1327)  time: 3.1585  data: 0.8162  max mem: 11729
Epoch: [4]  [ 60/360]  eta: 0:16:10  lr: 0.003490  loss: 0.5630 (0.5782)  loss_classifier: 0.2022 (0.2018)  loss_box_reg: 0.1938 (0.1968)  loss_objectness: 0.0471 (0.0493)  loss_rpn_box_reg: 0.1235 (0.1303)  time: 2.8437  data: 0.5319  max mem: 11729
Epoch: [4]  [ 80/360]  eta: 0:14:48  lr: 0.003490  loss: 0.5942 (0.5813)  loss_classifier: 0.2073 (0.2038)  loss_box_reg: 0.2028 (0.1982)  loss_objectness: 0.0445 (0.0490)  loss_rpn_box_reg: 0.1270 (0.1303)  time: 2.9858  data: 0.6848  max mem: 11729
Epoch: [4]  [100/360]  eta: 0:13:42  lr: 0.003490  loss: 0.5789 (0.5805)  loss_classifier: 0.1994 (0.2035)  loss_box_reg: 0.1914 (0.1982)  loss_objectness: 0.0476 (0.0486)  loss_rpn_box_reg: 0.1292 (0.1303)  time: 3.1188  data: 0.8107  max mem: 11729
Epoch: [4]  [120/360]  eta: 0:12:38  lr: 0.003490  loss: 0.5902 (0.5805)  loss_classifier: 0.2049 (0.2036)  loss_box_reg: 0.2007 (0.1982)  loss_objectness: 0.0468 (0.0485)  loss_rpn_box_reg: 0.1285 (0.1301)  time: 3.1623  data: 0.8511  max mem: 11729
Epoch: [4]  [140/360]  eta: 0:11:34  lr: 0.003490  loss: 0.5788 (0.5798)  loss_classifier: 0.2022 (0.2037)  loss_box_reg: 0.1948 (0.1980)  loss_objectness: 0.0468 (0.0483)  loss_rpn_box_reg: 0.1275 (0.1298)  time: 3.1291  data: 0.8286  max mem: 11729
Epoch: [4]  [160/360]  eta: 0:10:32  lr: 0.003490  loss: 0.5608 (0.5780)  loss_classifier: 0.1996 (0.2029)  loss_box_reg: 0.1923 (0.1973)  loss_objectness: 0.0447 (0.0480)  loss_rpn_box_reg: 0.1305 (0.1298)  time: 3.1888  data: 0.9104  max mem: 11729
Epoch: [4]  [180/360]  eta: 0:09:27  lr: 0.003490  loss: 0.5789 (0.5773)  loss_classifier: 0.2017 (0.2027)  loss_box_reg: 0.1941 (0.1971)  loss_objectness: 0.0469 (0.0481)  loss_rpn_box_reg: 0.1293 (0.1294)  time: 3.1008  data: 0.7770  max mem: 11729
Epoch: [4]  [200/360]  eta: 0:08:27  lr: 0.003490  loss: 0.5719 (0.5773)  loss_classifier: 0.1979 (0.2028)  loss_box_reg: 0.1964 (0.1972)  loss_objectness: 0.0442 (0.0478)  loss_rpn_box_reg: 0.1300 (0.1295)  time: 3.3045  data: 0.9608  max mem: 11729
Epoch: [4]  [220/360]  eta: 0:07:24  lr: 0.003490  loss: 0.5658 (0.5766)  loss_classifier: 0.2010 (0.2028)  loss_box_reg: 0.1939 (0.1971)  loss_objectness: 0.0439 (0.0476)  loss_rpn_box_reg: 0.1247 (0.1290)  time: 3.2596  data: 0.9068  max mem: 11729
Epoch: [4]  [240/360]  eta: 0:06:20  lr: 0.003490  loss: 0.5684 (0.5755)  loss_classifier: 0.1982 (0.2024)  loss_box_reg: 0.1912 (0.1968)  loss_objectness: 0.0419 (0.0475)  loss_rpn_box_reg: 0.1279 (0.1287)  time: 3.1345  data: 0.7701  max mem: 11729
Epoch: [4]  [260/360]  eta: 0:05:17  lr: 0.003490  loss: 0.5556 (0.5742)  loss_classifier: 0.1959 (0.2017)  loss_box_reg: 0.1951 (0.1966)  loss_objectness: 0.0432 (0.0473)  loss_rpn_box_reg: 0.1263 (0.1286)  time: 3.2165  data: 0.8862  max mem: 11729
Epoch: [4]  [280/360]  eta: 0:04:13  lr: 0.003490  loss: 0.5715 (0.5749)  loss_classifier: 0.2104 (0.2023)  loss_box_reg: 0.1996 (0.1968)  loss_objectness: 0.0420 (0.0470)  loss_rpn_box_reg: 0.1264 (0.1288)  time: 3.1069  data: 0.7900  max mem: 11729
Epoch: [4]  [300/360]  eta: 0:03:10  lr: 0.003490  loss: 0.5758 (0.5756)  loss_classifier: 0.2018 (0.2024)  loss_box_reg: 0.1973 (0.1969)  loss_objectness: 0.0498 (0.0473)  loss_rpn_box_reg: 0.1255 (0.1290)  time: 3.1447  data: 0.8100  max mem: 11729
Epoch: [4]  [320/360]  eta: 0:02:06  lr: 0.003490  loss: 0.5654 (0.5752)  loss_classifier: 0.1984 (0.2022)  loss_box_reg: 0.1948 (0.1968)  loss_objectness: 0.0462 (0.0473)  loss_rpn_box_reg: 0.1236 (0.1288)  time: 3.2343  data: 0.8511  max mem: 11729
Epoch: [4]  [340/360]  eta: 0:01:03  lr: 0.003490  loss: 0.5760 (0.5754)  loss_classifier: 0.2034 (0.2024)  loss_box_reg: 0.1946 (0.1970)  loss_objectness: 0.0451 (0.0472)  loss_rpn_box_reg: 0.1315 (0.1289)  time: 3.2825  data: 0.9621  max mem: 11729
Epoch: [4]  [359/360]  eta: 0:00:03  lr: 0.003490  loss: 0.5826 (0.5761)  loss_classifier: 0.2049 (0.2026)  loss_box_reg: 0.1968 (0.1972)  loss_objectness: 0.0448 (0.0472)  loss_rpn_box_reg: 0.1331 (0.1291)  time: 2.5297  data: 0.4738  max mem: 11729
Epoch: [4] Total time: 0:18:53 (3.1479 s / it)
creating index...
index created!
Test:  [ 0/32]  eta: 0:05:29  model_time: 0.8350 (0.8350)  evaluator_time: 4.3748 (4.3748)  time: 10.2937  data: 4.8968  max mem: 11729
Test:  [31/32]  eta: 0:00:03  model_time: 0.6501 (0.6501)  evaluator_time: 2.2127 (2.3768)  time: 3.0238  data: 0.0833  max mem: 11729
Test: Total time: 0:01:46 (3.3292 s / it)
Averaged stats: model_time: 0.6501 (0.6501)  evaluator_time: 2.2127 (2.3768)
Accumulating evaluation results...
DONE (t=0.53s).
IoU metric: bbox
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.526
 Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.919
 Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=100 ] = 0.567
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.059
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.538
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.504
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=  1 ] = 0.019
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets= 10 ] = 0.179
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.594
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.146
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.603
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.573
Epoch: [5]  [  0/360]  eta: 1:19:45  lr: 0.003490  loss: 0.5794 (0.5794)  loss_classifier: 0.1986 (0.1986)  loss_box_reg: 0.1921 (0.1921)  loss_objectness: 0.0406 (0.0406)  loss_rpn_box_reg: 0.1481 (0.1481)  time: 13.2923  data: 11.0382  max mem: 11729
Epoch: [5]  [ 20/360]  eta: 0:20:45  lr: 0.003490  loss: 0.5628 (0.5577)  loss_classifier: 0.1977 (0.1984)  loss_box_reg: 0.1918 (0.1913)  loss_objectness: 0.0420 (0.0412)  loss_rpn_box_reg: 0.1229 (0.1269)  time: 3.1818  data: 0.8687  max mem: 11729
Epoch: [5]  [ 40/360]  eta: 0:17:52  lr: 0.003490  loss: 0.5874 (0.5730)  loss_classifier: 0.2099 (0.2037)  loss_box_reg: 0.2032 (0.1972)  loss_objectness: 0.0452 (0.0434)  loss_rpn_box_reg: 0.1288 (0.1287)  time: 3.0274  data: 0.6793  max mem: 11729
Epoch: [5]  [ 60/360]  eta: 0:16:07  lr: 0.003490  loss: 0.5479 (0.5672)  loss_classifier: 0.1978 (0.2027)  loss_box_reg: 0.1866 (0.1955)  loss_objectness: 0.0411 (0.0427)  loss_rpn_box_reg: 0.1218 (0.1264)  time: 2.9649  data: 0.6332  max mem: 11729
Epoch: [5]  [ 80/360]  eta: 0:15:02  lr: 0.003490  loss: 0.5535 (0.5642)  loss_classifier: 0.1886 (0.2001)  loss_box_reg: 0.1952 (0.1943)  loss_objectness: 0.0421 (0.0425)  loss_rpn_box_reg: 0.1214 (0.1272)  time: 3.2118  data: 0.9007  max mem: 11729
Epoch: [5]  [100/360]  eta: 0:14:05  lr: 0.003490  loss: 0.5672 (0.5642)  loss_classifier: 0.1927 (0.1996)  loss_box_reg: 0.1948 (0.1946)  loss_objectness: 0.0412 (0.0424)  loss_rpn_box_reg: 0.1293 (0.1276)  time: 3.3624  data: 0.9930  max mem: 11729
Epoch: [5]  [120/360]  eta: 0:12:55  lr: 0.003490  loss: 0.5668 (0.5648)  loss_classifier: 0.2012 (0.2003)  loss_box_reg: 0.1978 (0.1951)  loss_objectness: 0.0399 (0.0421)  loss_rpn_box_reg: 0.1236 (0.1273)  time: 3.1468  data: 0.8383  max mem: 11729
Epoch: [5]  [140/360]  eta: 0:11:47  lr: 0.003490  loss: 0.5789 (0.5661)  loss_classifier: 0.1956 (0.2005)  loss_box_reg: 0.1982 (0.1953)  loss_objectness: 0.0393 (0.0421)  loss_rpn_box_reg: 0.1319 (0.1282)  time: 3.1138  data: 0.8045  max mem: 11729
Epoch: [5]  [160/360]  eta: 0:10:40  lr: 0.003490  loss: 0.5524 (0.5647)  loss_classifier: 0.1957 (0.2001)  loss_box_reg: 0.1936 (0.1951)  loss_objectness: 0.0400 (0.0419)  loss_rpn_box_reg: 0.1232 (0.1276)  time: 3.1241  data: 0.7776  max mem: 11729
Epoch: [5]  [180/360]  eta: 0:09:37  lr: 0.003490  loss: 0.5481 (0.5629)  loss_classifier: 0.1948 (0.1994)  loss_box_reg: 0.1858 (0.1943)  loss_objectness: 0.0407 (0.0420)  loss_rpn_box_reg: 0.1259 (0.1272)  time: 3.2487  data: 0.9075  max mem: 11729
Epoch: [5]  [200/360]  eta: 0:08:34  lr: 0.003490  loss: 0.5574 (0.5628)  loss_classifier: 0.1933 (0.1992)  loss_box_reg: 0.1916 (0.1942)  loss_objectness: 0.0440 (0.0423)  loss_rpn_box_reg: 0.1276 (0.1271)  time: 3.2730  data: 0.9193  max mem: 11729
Epoch: [5]  [220/360]  eta: 0:07:29  lr: 0.003490  loss: 0.5707 (0.5628)  loss_classifier: 0.1965 (0.1990)  loss_box_reg: 0.1943 (0.1939)  loss_objectness: 0.0435 (0.0425)  loss_rpn_box_reg: 0.1301 (0.1275)  time: 3.1895  data: 0.8696  max mem: 11729
Epoch: [5]  [240/360]  eta: 0:06:27  lr: 0.003490  loss: 0.5569 (0.5630)  loss_classifier: 0.1956 (0.1992)  loss_box_reg: 0.1945 (0.1939)  loss_objectness: 0.0408 (0.0425)  loss_rpn_box_reg: 0.1237 (0.1274)  time: 3.3677  data: 1.0215  max mem: 11729
Epoch: [5]  [260/360]  eta: 0:05:22  lr: 0.003490  loss: 0.5693 (0.5636)  loss_classifier: 0.2009 (0.1997)  loss_box_reg: 0.1901 (0.1941)  loss_objectness: 0.0444 (0.0426)  loss_rpn_box_reg: 0.1288 (0.1272)  time: 3.2284  data: 0.9082  max mem: 11729
Epoch: [5]  [280/360]  eta: 0:04:17  lr: 0.003490  loss: 0.5668 (0.5644)  loss_classifier: 0.1974 (0.1998)  loss_box_reg: 0.1946 (0.1943)  loss_objectness: 0.0400 (0.0429)  loss_rpn_box_reg: 0.1298 (0.1274)  time: 3.1832  data: 0.7989  max mem: 11729
Epoch: [5]  [300/360]  eta: 0:03:14  lr: 0.003490  loss: 0.5569 (0.5641)  loss_classifier: 0.1939 (0.1995)  loss_box_reg: 0.1919 (0.1942)  loss_objectness: 0.0437 (0.0430)  loss_rpn_box_reg: 0.1253 (0.1274)  time: 3.4250  data: 1.0921  max mem: 11729
Epoch: [5]  [320/360]  eta: 0:02:08  lr: 0.003490  loss: 0.5664 (0.5641)  loss_classifier: 0.2037 (0.1996)  loss_box_reg: 0.1919 (0.1941)  loss_objectness: 0.0462 (0.0431)  loss_rpn_box_reg: 0.1260 (0.1273)  time: 3.0292  data: 0.7571  max mem: 11729
Epoch: [5]  [340/360]  eta: 0:01:04  lr: 0.003490  loss: 0.5717 (0.5648)  loss_classifier: 0.1988 (0.1999)  loss_box_reg: 0.2015 (0.1944)  loss_objectness: 0.0419 (0.0431)  loss_rpn_box_reg: 0.1243 (0.1274)  time: 3.0315  data: 0.7154  max mem: 11729
Epoch: [5]  [359/360]  eta: 0:00:03  lr: 0.003490  loss: 0.5541 (0.5637)  loss_classifier: 0.1982 (0.1995)  loss_box_reg: 0.1896 (0.1940)  loss_objectness: 0.0419 (0.0431)  loss_rpn_box_reg: 0.1181 (0.1270)  time: 2.7932  data: 0.8020  max mem: 11729
Epoch: [5] Total time: 0:19:07 (3.1871 s / it)
creating index...
index created!
Test:  [ 0/32]  eta: 0:05:30  model_time: 0.8013 (0.8013)  evaluator_time: 5.0437 (5.0437)  time: 10.3229  data: 4.2872  max mem: 11729
Test:  [31/32]  eta: 0:00:03  model_time: 0.6493 (0.6443)  evaluator_time: 2.0070 (2.3158)  time: 2.8653  data: 0.0789  max mem: 11729
Test: Total time: 0:01:43 (3.2389 s / it)
Averaged stats: model_time: 0.6493 (0.6443)  evaluator_time: 2.0070 (2.3158)
Accumulating evaluation results...
DONE (t=0.75s).
IoU metric: bbox
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.521
 Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.918
 Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=100 ] = 0.554
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.069
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.530
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.506
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=  1 ] = 0.019
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets= 10 ] = 0.179
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.588
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.168
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.595
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.575
Epoch: [6]  [  0/360]  eta: 1:21:40  lr: 0.003490  loss: 0.5498 (0.5498)  loss_classifier: 0.1936 (0.1936)  loss_box_reg: 0.1949 (0.1949)  loss_objectness: 0.0365 (0.0365)  loss_rpn_box_reg: 0.1248 (0.1248)  time: 13.6129  data: 11.4128  max mem: 11729
Epoch: [6]  [ 20/360]  eta: 0:21:24  lr: 0.003490  loss: 0.5442 (0.5524)  loss_classifier: 0.1938 (0.1954)  loss_box_reg: 0.1856 (0.1897)  loss_objectness: 0.0403 (0.0426)  loss_rpn_box_reg: 0.1197 (0.1246)  time: 3.2860  data: 0.9840  max mem: 11729
Epoch: [6]  [ 40/360]  eta: 0:18:27  lr: 0.003490  loss: 0.5439 (0.5528)  loss_classifier: 0.1939 (0.1967)  loss_box_reg: 0.1888 (0.1895)  loss_objectness: 0.0361 (0.0411)  loss_rpn_box_reg: 0.1241 (0.1254)  time: 3.1300  data: 0.8403  max mem: 11729
Epoch: [6]  [ 60/360]  eta: 0:16:42  lr: 0.003490  loss: 0.5541 (0.5564)  loss_classifier: 0.1965 (0.1975)  loss_box_reg: 0.1955 (0.1908)  loss_objectness: 0.0409 (0.0419)  loss_rpn_box_reg: 0.1253 (0.1263)  time: 3.0999  data: 0.7188  max mem: 11729
Epoch: [6]  [ 80/360]  eta: 0:15:23  lr: 0.003490  loss: 0.5617 (0.5580)  loss_classifier: 0.1967 (0.1979)  loss_box_reg: 0.1959 (0.1918)  loss_objectness: 0.0395 (0.0415)  loss_rpn_box_reg: 0.1285 (0.1268)  time: 3.1571  data: 0.8122  max mem: 11729
Epoch: [6]  [100/360]  eta: 0:14:09  lr: 0.003490  loss: 0.5482 (0.5571)  loss_classifier: 0.1982 (0.1976)  loss_box_reg: 0.1906 (0.1917)  loss_objectness: 0.0402 (0.0414)  loss_rpn_box_reg: 0.1271 (0.1264)  time: 3.1416  data: 0.8063  max mem: 11729
Epoch: [6]  [120/360]  eta: 0:13:03  lr: 0.003490  loss: 0.5419 (0.5577)  loss_classifier: 0.2020 (0.1982)  loss_box_reg: 0.1945 (0.1922)  loss_objectness: 0.0395 (0.0412)  loss_rpn_box_reg: 0.1218 (0.1260)  time: 3.2598  data: 0.9486  max mem: 11729
Epoch: [6]  [140/360]  eta: 0:11:55  lr: 0.003490  loss: 0.5652 (0.5583)  loss_classifier: 0.1967 (0.1983)  loss_box_reg: 0.1882 (0.1921)  loss_objectness: 0.0420 (0.0414)  loss_rpn_box_reg: 0.1286 (0.1265)  time: 3.1829  data: 0.8841  max mem: 11729
Epoch: [6]  [160/360]  eta: 0:10:45  lr: 0.003490  loss: 0.5569 (0.5575)  loss_classifier: 0.1983 (0.1982)  loss_box_reg: 0.1910 (0.1920)  loss_objectness: 0.0409 (0.0413)  loss_rpn_box_reg: 0.1230 (0.1259)  time: 3.0298  data: 0.6759  max mem: 11729
Epoch: [6]  [180/360]  eta: 0:09:39  lr: 0.003490  loss: 0.5572 (0.5577)  loss_classifier: 0.2015 (0.1985)  loss_box_reg: 0.1957 (0.1921)  loss_objectness: 0.0401 (0.0414)  loss_rpn_box_reg: 0.1217 (0.1259)  time: 3.1741  data: 0.8442  max mem: 11729
Epoch: [6]  [200/360]  eta: 0:08:35  lr: 0.003490  loss: 0.5471 (0.5575)  loss_classifier: 0.2018 (0.1987)  loss_box_reg: 0.1878 (0.1918)  loss_objectness: 0.0419 (0.0413)  loss_rpn_box_reg: 0.1233 (0.1257)  time: 3.2210  data: 0.8898  max mem: 11729
Epoch: [6]  [220/360]  eta: 0:07:29  lr: 0.003490  loss: 0.5660 (0.5578)  loss_classifier: 0.2031 (0.1990)  loss_box_reg: 0.1905 (0.1918)  loss_objectness: 0.0429 (0.0414)  loss_rpn_box_reg: 0.1246 (0.1256)  time: 3.1098  data: 0.7419  max mem: 11729
Epoch: [6]  [240/360]  eta: 0:06:23  lr: 0.003490  loss: 0.5690 (0.5597)  loss_classifier: 0.2041 (0.1997)  loss_box_reg: 0.1991 (0.1923)  loss_objectness: 0.0440 (0.0418)  loss_rpn_box_reg: 0.1265 (0.1259)  time: 3.0780  data: 0.7521  max mem: 11729
Epoch: [6]  [260/360]  eta: 0:05:19  lr: 0.003490  loss: 0.5568 (0.5594)  loss_classifier: 0.1976 (0.1995)  loss_box_reg: 0.1919 (0.1923)  loss_objectness: 0.0383 (0.0415)  loss_rpn_box_reg: 0.1291 (0.1262)  time: 3.1543  data: 0.8411  max mem: 11729
Epoch: [6]  [280/360]  eta: 0:04:15  lr: 0.003490  loss: 0.5526 (0.5586)  loss_classifier: 0.1923 (0.1990)  loss_box_reg: 0.1890 (0.1920)  loss_objectness: 0.0392 (0.0416)  loss_rpn_box_reg: 0.1239 (0.1261)  time: 3.1975  data: 0.8479  max mem: 11729
Epoch: [6]  [300/360]  eta: 0:03:11  lr: 0.003490  loss: 0.5501 (0.5583)  loss_classifier: 0.1898 (0.1985)  loss_box_reg: 0.1915 (0.1919)  loss_objectness: 0.0431 (0.0417)  loss_rpn_box_reg: 0.1310 (0.1263)  time: 3.2562  data: 0.9578  max mem: 11729
Epoch: [6]  [320/360]  eta: 0:02:08  lr: 0.003490  loss: 0.5619 (0.5584)  loss_classifier: 0.1998 (0.1986)  loss_box_reg: 0.1968 (0.1919)  loss_objectness: 0.0376 (0.0417)  loss_rpn_box_reg: 0.1228 (0.1262)  time: 3.2863  data: 0.9376  max mem: 11729
Epoch: [6]  [340/360]  eta: 0:01:03  lr: 0.003490  loss: 0.5370 (0.5573)  loss_classifier: 0.1926 (0.1983)  loss_box_reg: 0.1828 (0.1916)  loss_objectness: 0.0353 (0.0415)  loss_rpn_box_reg: 0.1202 (0.1260)  time: 2.9411  data: 0.6391  max mem: 11729
Epoch: [6]  [359/360]  eta: 0:00:03  lr: 0.003490  loss: 0.5374 (0.5565)  loss_classifier: 0.1879 (0.1979)  loss_box_reg: 0.1842 (0.1915)  loss_objectness: 0.0383 (0.0413)  loss_rpn_box_reg: 0.1202 (0.1257)  time: 2.6598  data: 0.5592  max mem: 11729
Epoch: [6] Total time: 0:18:57 (3.1585 s / it)
creating index...
index created!
Test:  [ 0/32]  eta: 0:05:38  model_time: 0.8280 (0.8280)  evaluator_time: 5.2903 (5.2903)  time: 10.5675  data: 4.2597  max mem: 11729
Test:  [31/32]  eta: 0:00:03  model_time: 0.6524 (0.6469)  evaluator_time: 2.0833 (2.3934)  time: 2.8762  data: 0.0797  max mem: 11729
Test: Total time: 0:01:46 (3.3203 s / it)
Averaged stats: model_time: 0.6524 (0.6469)  evaluator_time: 2.0833 (2.3934)
Accumulating evaluation results...
DONE (t=0.51s).
IoU metric: bbox
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.534
 Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.920
 Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=100 ] = 0.575
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.060
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.547
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.492
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=  1 ] = 0.020
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets= 10 ] = 0.180
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.598
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.198
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.614
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.547
Epoch: [7]  [  0/360]  eta: 1:10:42  lr: 0.003490  loss: 0.5844 (0.5844)  loss_classifier: 0.2008 (0.2008)  loss_box_reg: 0.2099 (0.2099)  loss_objectness: 0.0384 (0.0384)  loss_rpn_box_reg: 0.1353 (0.1353)  time: 11.7848  data: 9.3694  max mem: 11729
Epoch: [7]  [ 20/360]  eta: 0:19:53  lr: 0.003490  loss: 0.5492 (0.5561)  loss_classifier: 0.1965 (0.1960)  loss_box_reg: 0.1881 (0.1914)  loss_objectness: 0.0390 (0.0406)  loss_rpn_box_reg: 0.1271 (0.1280)  time: 3.0951  data: 0.7803  max mem: 11729
Epoch: [7]  [ 40/360]  eta: 0:17:23  lr: 0.003490  loss: 0.5717 (0.5579)  loss_classifier: 0.2001 (0.1968)  loss_box_reg: 0.1958 (0.1936)  loss_objectness: 0.0385 (0.0402)  loss_rpn_box_reg: 0.1238 (0.1273)  time: 3.0028  data: 0.6771  max mem: 11729
Epoch: [7]  [ 60/360]  eta: 0:16:14  lr: 0.003490  loss: 0.5487 (0.5530)  loss_classifier: 0.1926 (0.1942)  loss_box_reg: 0.1884 (0.1917)  loss_objectness: 0.0394 (0.0402)  loss_rpn_box_reg: 0.1219 (0.1270)  time: 3.2194  data: 0.9122  max mem: 11729
Epoch: [7]  [ 80/360]  eta: 0:14:58  lr: 0.003490  loss: 0.5211 (0.5473)  loss_classifier: 0.1923 (0.1931)  loss_box_reg: 0.1861 (0.1895)  loss_objectness: 0.0338 (0.0390)  loss_rpn_box_reg: 0.1194 (0.1257)  time: 3.0836  data: 0.7513  max mem: 11729
Epoch: [7]  [100/360]  eta: 0:13:41  lr: 0.003490  loss: 0.5528 (0.5485)  loss_classifier: 0.1944 (0.1938)  loss_box_reg: 0.1916 (0.1903)  loss_objectness: 0.0381 (0.0390)  loss_rpn_box_reg: 0.1212 (0.1254)  time: 2.9562  data: 0.6086  max mem: 11729
Epoch: [7]  [120/360]  eta: 0:12:30  lr: 0.003490  loss: 0.5379 (0.5460)  loss_classifier: 0.1865 (0.1928)  loss_box_reg: 0.1807 (0.1890)  loss_objectness: 0.0335 (0.0390)  loss_rpn_box_reg: 0.1241 (0.1252)  time: 2.9814  data: 0.6639  max mem: 11729
Epoch: [7]  [140/360]  eta: 0:11:24  lr: 0.003490  loss: 0.5373 (0.5472)  loss_classifier: 0.1946 (0.1935)  loss_box_reg: 0.1910 (0.1892)  loss_objectness: 0.0406 (0.0393)  loss_rpn_box_reg: 0.1221 (0.1252)  time: 3.0165  data: 0.7082  max mem: 11729
Epoch: [7]  [160/360]  eta: 0:10:19  lr: 0.003490  loss: 0.5519 (0.5483)  loss_classifier: 0.1943 (0.1939)  loss_box_reg: 0.1899 (0.1895)  loss_objectness: 0.0378 (0.0394)  loss_rpn_box_reg: 0.1250 (0.1255)  time: 2.9897  data: 0.6744  max mem: 11729
Epoch: [7]  [180/360]  eta: 0:09:15  lr: 0.003490  loss: 0.5354 (0.5489)  loss_classifier: 0.1950 (0.1941)  loss_box_reg: 0.1860 (0.1896)  loss_objectness: 0.0374 (0.0395)  loss_rpn_box_reg: 0.1240 (0.1257)  time: 3.0089  data: 0.7134  max mem: 11729
Epoch: [7]  [200/360]  eta: 0:08:14  lr: 0.003490  loss: 0.5561 (0.5498)  loss_classifier: 0.1989 (0.1944)  loss_box_reg: 0.1968 (0.1904)  loss_objectness: 0.0368 (0.0394)  loss_rpn_box_reg: 0.1255 (0.1256)  time: 3.1452  data: 0.8313  max mem: 11729
Epoch: [7]  [220/360]  eta: 0:07:13  lr: 0.003490  loss: 0.5461 (0.5495)  loss_classifier: 0.1954 (0.1946)  loss_box_reg: 0.1838 (0.1902)  loss_objectness: 0.0358 (0.0391)  loss_rpn_box_reg: 0.1266 (0.1256)  time: 3.1370  data: 0.8228  max mem: 11729
Epoch: [7]  [240/360]  eta: 0:06:11  lr: 0.003490  loss: 0.5286 (0.5479)  loss_classifier: 0.1814 (0.1940)  loss_box_reg: 0.1845 (0.1897)  loss_objectness: 0.0351 (0.0389)  loss_rpn_box_reg: 0.1210 (0.1252)  time: 3.1258  data: 0.8279  max mem: 11729
Epoch: [7]  [260/360]  eta: 0:05:10  lr: 0.003490  loss: 0.5433 (0.5482)  loss_classifier: 0.1980 (0.1944)  loss_box_reg: 0.1915 (0.1899)  loss_objectness: 0.0371 (0.0390)  loss_rpn_box_reg: 0.1197 (0.1249)  time: 3.1377  data: 0.8132  max mem: 11729
Epoch: [7]  [280/360]  eta: 0:04:08  lr: 0.003490  loss: 0.5415 (0.5479)  loss_classifier: 0.1912 (0.1942)  loss_box_reg: 0.1848 (0.1896)  loss_objectness: 0.0387 (0.0391)  loss_rpn_box_reg: 0.1276 (0.1250)  time: 3.1775  data: 0.8794  max mem: 11729
Epoch: [7]  [300/360]  eta: 0:03:06  lr: 0.003490  loss: 0.5357 (0.5472)  loss_classifier: 0.1909 (0.1940)  loss_box_reg: 0.1846 (0.1895)  loss_objectness: 0.0335 (0.0390)  loss_rpn_box_reg: 0.1186 (0.1247)  time: 3.1074  data: 0.7873  max mem: 11729
Epoch: [7]  [320/360]  eta: 0:02:04  lr: 0.003490  loss: 0.5476 (0.5472)  loss_classifier: 0.1980 (0.1942)  loss_box_reg: 0.1881 (0.1896)  loss_objectness: 0.0364 (0.0389)  loss_rpn_box_reg: 0.1235 (0.1245)  time: 3.1675  data: 0.8459  max mem: 11729
Epoch: [7]  [340/360]  eta: 0:01:02  lr: 0.003490  loss: 0.5454 (0.5466)  loss_classifier: 0.1927 (0.1941)  loss_box_reg: 0.1898 (0.1894)  loss_objectness: 0.0351 (0.0387)  loss_rpn_box_reg: 0.1190 (0.1243)  time: 3.0625  data: 0.7272  max mem: 11729
Epoch: [7]  [359/360]  eta: 0:00:03  lr: 0.003490  loss: 0.5227 (0.5461)  loss_classifier: 0.1895 (0.1940)  loss_box_reg: 0.1855 (0.1893)  loss_objectness: 0.0356 (0.0386)  loss_rpn_box_reg: 0.1187 (0.1242)  time: 2.8314  data: 0.7063  max mem: 11729
Epoch: [7] Total time: 0:18:33 (3.0944 s / it)
creating index...
index created!
Test:  [ 0/32]  eta: 0:05:56  model_time: 0.8585 (0.8585)  evaluator_time: 5.7498 (5.7498)  time: 11.1505  data: 4.3719  max mem: 11729
Test:  [31/32]  eta: 0:00:03  model_time: 0.6516 (0.6449)  evaluator_time: 2.0432 (2.3215)  time: 2.8866  data: 0.0851  max mem: 11729
Test: Total time: 0:01:44 (3.2697 s / it)
Averaged stats: model_time: 0.6516 (0.6449)  evaluator_time: 2.0432 (2.3215)
Accumulating evaluation results...
DONE (t=0.51s).
IoU metric: bbox
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.513
 Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.919
 Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=100 ] = 0.539
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.048
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.524
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.480
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=  1 ] = 0.019
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets= 10 ] = 0.175
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.577
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.182
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.593
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.528